From 9455d5bc5d4ff9e2a6e4b646c3cf7c1ac7b0e312 Mon Sep 17 00:00:00 2001
From: mistrmochov <matejdvoracek@fastmail.com>
Date: Mon, 1 Sep 2025 23:36:36 +0200
Subject: [PATCH 18/21] post sync corrections

---
 .gitattributes                             |   1 +
 native/src/core/rezygisk/rezygisk.zip      | Bin 436045 -> 436048 bytes
 native/src/core/rezygisk/util_functions.sh |   4 ++--
 native/src/core/zygisk/daemon.rs           |  20 --------------------
 4 files changed, 3 insertions(+), 22 deletions(-)

diff --git a/.gitattributes b/.gitattributes
index eed785ce8..96001a85c 100644
--- a/.gitattributes
+++ b/.gitattributes
@@ -14,6 +14,7 @@
 tools/** binary
 tools/rustup-wrapper/** -binary
 tools/elf-cleaner/** -binary
+native/src/core/rezygisk/rezygisk.zip binary
 *.jar binary
 *.exe binary
 *.apk binary
diff --git a/native/src/core/rezygisk/rezygisk.zip b/native/src/core/rezygisk/rezygisk.zip
index 909f0ccd636de4d638979396e4483861fbbc06a7..89100b074174b511078cf100999c5f88961abca4 100644
GIT binary patch
delta 48
zcmV-00MGx;&Kl6p8nB$o0S$wk%D0@#0rS!U4Y!Y-0{M6W4Tp#p1BZwf1c!(g1-FP6
G2E~v(ycGKY

delta 42
zcmV+_0M-A{&Kk|m8nB$ogPqE^oyr08(zlVF0{M7{ixvZiixvcjixvg9ixvjOkop!B
A;Q#;t

diff --git a/native/src/core/rezygisk/util_functions.sh b/native/src/core/rezygisk/util_functions.sh
index 64cc45843..52347ee49 100644
--- a/native/src/core/rezygisk/util_functions.sh
+++ b/native/src/core/rezygisk/util_functions.sh
@@ -2,8 +2,8 @@
 # Magisk General Utility Functions
 ############################################
 
-MAGISK_VER='30.1-Waydroid'
-MAGISK_VER_CODE=30100
+MAGISK_VER='30.2-Waydroid'
+MAGISK_VER_CODE=30200
 
 ###################
 # Global Variables
diff --git a/native/src/core/zygisk/daemon.rs b/native/src/core/zygisk/daemon.rs
index c771b3cff..4bd60ebf6 100644
--- a/native/src/core/zygisk/daemon.rs
+++ b/native/src/core/zygisk/daemon.rs
@@ -177,26 +177,6 @@ impl MagiskD {
         };
     }
 
-    pub fn zygisk_reset(&self, mut restore: bool) {
-        if !self.zygisk_enabled.load(Ordering::Acquire) {
-            return;
-        }
-
-        if restore {
-            self.zygote_start_count.store(1, Ordering::Release);
-        } else {
-            *self.zygiskd_sockets.lock().unwrap() = (None, None);
-            if self.zygote_start_count.fetch_add(1, Ordering::AcqRel) > 3 {
-                warn!("zygote crashes too many times, rolling-back");
-                restore = true;
-            }
-        }
-
-        if restore {
-            restore_zygisk_prop();
-        }
-    }
-
     fn get_module_fds(&self, is_64_bit: bool) -> Option<Vec<RawFd>> {
         self.module_list.get().map(|module_list| {
             module_list
-- 
2.52.0

